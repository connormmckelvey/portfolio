<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Connor McKelvey — Electrical & Computer Engineer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Connor McKelvey — Electrical & Computer Engineer in Honors Robotics at UT Austin. Embedded systems, robotics, and utilizing data" />
  <meta name="theme-color" content="#06150e" />

  <meta property="og:title" content="Connor McKelvey — Engineer" />
  <meta property="og:description" content="Embedded Systems · Robotics · Tools that ship." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="images/Headshot.JPG" />

  <link rel="stylesheet" href="style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
</head>
<body>

  <a class="skip-link" href="#main">Skip to content</a>

  <header class="hero" id="top">
    <div class="overlay" aria-hidden="true"></div>

    <nav class="nav" aria-label="Primary">
      <a class="brand" href="#top">CM</a>
      <div class="nav-links">
        <a href="#projects">Projects</a>
        <a href="#education">Education</a>
        <a href="#leadership">Leadership</a>
        <a href="#skills">Skills</a>
        <a href="#github">GitHub</a>
        <a href="#about">About</a>
        <a href="#journey">Journey</a>
        <a href="#contact">Contact</a>
        <a class="nav-blog" href="blog.html">Blog</a>
        <a class="nav-cta" href="connor-mckelvey-resume.pdf" target="_blank" rel="noopener">Resume</a>
      </div>
    </nav>
    <div class="hero-content">
      <h1>Connor McKelvey</h1>
      <p>Is an Eagle Scout leading innovation in how technology shapes our world.</p>
      <ul class="hero-highlights" aria-label="At a glance">
        <li>2029 UT Austin ECE </li>
        <li>Honors Robotics Program</li>
        <li>Strategic Planning at IT Bridge</li>
      </ul>
      <div class="hero-actions">
        <a href="#projects" class="btn">Explore My Work</a>
        <a href="#contact" class="btn btn-ghost">Get in touch</a>
      </div>
      <p class="subtle"></p> 
    </div>
  </header>

  <main id="main">

  <section id="projects" class="section">
    <h2>Featured Projects</h2>
    <div class="filters" role="group" aria-label="Filter projects">
      <button class="filter" type="button" data-filter="all" aria-pressed="true">All</button>
      <button class="filter" type="button" data-filter="robotics" aria-pressed="false">Robotics</button>
      <button class="filter" type="button" data-filter="embedded" aria-pressed="false">Embedded</button>
      <button class="filter" type="button" data-filter="tooling" aria-pressed="false">Tooling</button>
      <button class="filter" type="button" data-filter="education" aria-pressed="false">Education</button>
    </div>
    <div class="card-grid">
      <article class="card project-card" data-project="fireball" data-tags="tooling automation python">
        <h3>Fireball Dice Roller (Discord Bot)</h3>
        <p>Verified Discord bot (10,000+ users / 150 servers) with a flexible dice engine for multiple TTRPG systems.</p>
        <div class="tags"><span>tooling</span><span>python</span><span>discord api</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="fireball">Details</button>
        </div>
      </article>

      <article class="card project-card" data-project="logic" data-tags="tooling education ece godot">
        <h3>Circuit Board Digital Logic Simulator</h3>
        <p>Published grid-based simulator in Godot for learning digital logic: gates, signals, and circuit behavior.</p>
        <div class="tags"><span>tooling</span><span>education</span><span>godot</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="logic">Details</button>
        </div>
      </article>

      <article class="card project-card" data-project="curriculum" data-tags="education systems teaching">
        <h3>High School CS Curriculum (Bavaria)</h3>
        <p>10th-grade project-based game-dev curriculum teaching OOP + composition in 14 lessons.</p>
        <div class="tags"><span>education</span><span>systems</span><span>writing</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="curriculum">Details</button>
        </div>
      </article>

      <article class="card project-card" data-project="arm" data-tags="robotics embedded mechatronics">
        <h3>Drawing Robot Arm</h3>
        <p>Two-jointed drawing arm for research: inverse kinematics, image simplification, serial comms, buffering.</p>
        <div class="tags"><span>robotics</span><span>embedded</span><span>controls</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="arm">Details</button>
        </div>
      </article>

      <article class="card project-card" data-project="itbridge" data-tags="embedded education leadership">
        <h3>IEEE Hardware Program (IT Bridge)</h3>
        <p>Built a long-term hardware program (IEEE) to teach EE careers through repeatable, hands-on builds.</p>
        <div class="tags"><span>embedded</span><span>education</span><span>leadership</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="itbridge">Details</button>
        </div>
      </article>

      <article class="card project-card" data-project="krazy" data-tags="tooling leadership systems">
        <h3>Krazy Studios</h3>
        <p>Founded and led a small team shipping chatbots + Discord games for clients and communities.</p>
        <div class="tags"><span>leadership</span><span>tooling</span><span>delivery</span></div>
        <div class="card-actions">
          <button class="card-action" type="button" data-open-project="krazy">Details</button>
        </div>
      </article>
    </div>
    <p class="subtle" id="projects-status" aria-live="polite"></p>
  </section>

  <section id="education" class="section dark">
    <h2>Education</h2>
    <div class="split">
      <div>
        <p class="wide">
          University of Texas at Austin — B.S. in Electrical &amp; Computer Engineering
        </p>
        <ul class="facts" aria-label="Education details">
          <li>Honors Robotics Program, Robotics Minor</li>
          <li>Expected graduation: 2029</li>
          <li>Related coursework: Multivariable Calculus, Electrical Engineering, Embedded Systems</li>
        </ul>
      </div>

      <article class="card" aria-label="Current focus">
        <h3>Current focus</h3>
        <p>Learning low level computer architecture and embedded systems while researching medical robotics with a focus on haptics</p>
        <div class="tags">
          <span>medical robotics</span>
          <span>haptics</span>
          <span>embedded systems</span>
          <span>C/C++</span>
          <span>leadership</span>
        </div>
      </article>
    </div>
  </section>

  <!-- <section id="leadership" class="section">
    <h2>Experience &amp; Leadership</h2>
    <p class="wide">Highlights from leadership and community work — open the entries in <a class="inline-link" href="#journey">Journey</a> for full details.</p>
    <ul class="facts" aria-label="Experience highlights">
      <li>Software Developer &amp; Founder — Krazy Studios</li>
      <li>IEEE Assistant Officer — External Activities &amp; Events (UT Austin)</li>
      <li>Eagle Scout — Boy Scouts of America</li>
      <li>President &amp; Founder — Computer Science Club (Concordia Lutheran HS)</li>
    </ul>
  </section> -->

  <section id="skills" class="section dark">
    <h2>Technical Skills</h2>
    <div class="card-grid">
      <article class="card">
        <h3>Software / Programming</h3>
        <p>Tools-first engineering with clean interfaces and predictable behavior.</p>
        <div class="tags">
          <span>python</span><span>c</span><span>c++</span><span>java</span><span>godot engine</span><span>git</span><span>discord api</span>
        </div>
      </article>

      <article class="card">
        <h3>Hardware / Tools</h3>
        <p>Hands-on build + debug: electronics, integration, and real constraints.</p>
        <div class="tags">
          <span>arduino</span><span>stm32</span><span>circuit design</span><span>soldering</span><span>robotics systems</span>
        </div>
      </article>

      <article class="card">
        <h3>Soft Skills</h3>
        <p>Leadership that translates into shipped, reliable systems.</p>
        <div class="tags">
          <span>public speaking</span><span>servant leadership</span><span>reliability</span><span>delegation</span>
        </div>
      </article>
    </div>
  </section>

  <section id="github" class="section">
    <h2>Recent on GitHub</h2>
    <div class="github" id="github-repos" data-username="connormmckelvey" data-source="recent">
      <p class="wide">
        A snapshot of what I’ve been shipping lately. Full profile: <a class="inline-link" data-profile href="https://github.com/connormmckelvey" target="_blank" rel="noopener">github.com/connormmckelvey</a>.
      </p>
      <p class="subtle" data-status>Loading repositories…</p>
      <div class="lang-summary" aria-label="Top languages" data-langs hidden></div>
      <div class="card-grid" data-grid aria-live="polite"></div>
      <div class="github-actions">
        <a class="btn btn-ghost" href="https://github.com/connormmckelvey?tab=repositories" target="_blank" rel="noopener">View all repos</a>
      </div>
    </div>
  </section>

  <section id="about" class="section dark">
    <h2>Engineering Philosophy</h2>
    <div class="split">
      <div>
        <p class="wide">
          I build systems that interact with the real world — robotics, embedded systems, and tools that hold up under real use.
          I care about reliability, clear interfaces, and designs that survive contact with reality.
        </p>
        <p class="wide">
          I’m happiest where software meets hardware, and where "works on my machine" turns into repeatable results.
        </p>
        <ul class="facts" aria-label="Highlights">
          <li>Focus: embedded systems, autonomy, and practical tools</li>
          <li>Style: pragmatic engineering, clean interfaces, and rigorous iteration</li>
          <li>North star: systems that don’t crumble outside the lab</li>
        </ul>
      </div>
      <figure class="portrait">
        <img src="images/Headshot.JPG" alt="Portrait photo of Connor McKelvey" loading="lazy" />
      </figure>
    </div>
  </section>

  <section id="journey" class="section">
    <h2>Journey</h2>
    <p class="wide">Click an entry to expand it.</p>
    <div class="timeline" data-journey>
      <div class="event-item">
        <button class="event" type="button" aria-expanded="false" aria-controls="journey-eagle" data-journey-toggle>
          Eagle Scout — Boy Scouts of America
          <span class="event-hint" aria-hidden="true">Click to expand</span>
        </button>
        <div class="event-details" id="journey-eagle" hidden>
          <p class="subtle">Servant leadership with high-accountability execution.</p>
          <ul class="event-bullets">
            <li>Selected as 1 of 4 youth in the Houston area to lead a national leadership course</li>
            <li>Led 1,000+ hours of service and major community projects</li>
            <li>Mentored new youth leaders as Junior Assistant Scoutmaster</li>
          </ul>
        </div>
      </div>

      <div class="event-item">
        <button class="event" type="button" aria-expanded="false" aria-controls="journey-csclub" data-journey-toggle>
          President &amp; Founder — Computer Science Club (Concordia Lutheran HS)
          <span class="event-hint" aria-hidden="true">Click to expand</span>
        </button>
        <div class="event-details" id="journey-csclub" hidden>
          <p class="subtle">Built a team and a culture from zero; trained students for real competition.</p>
          <ul class="event-bullets">
            <li>Grew membership from 0 to a committed group of about 15 individuals</li>
            <li>Organized and trained teams for HPE CodeWars (novice + advanced)</li>
          </ul>
        </div>
      </div>

      <div class="event-item">
        <button class="event" type="button" aria-expanded="false" aria-controls="journey-krazy" data-journey-toggle>
          Software Developer &amp; Founder — Krazy Studios
          <span class="event-hint" aria-hidden="true">Click to expand</span>
        </button>
        <div class="event-details" id="journey-krazy" hidden>
          <p class="subtle">Established and led a team to publish chatbots and Discord-based games.</p>
          <ul class="event-bullets">
            <li>Delivered private client bots and built community engagement</li>
            <li>Built workflows around shipping, reliability, and clear ownership</li>
          </ul>
        </div>
      </div>

      <div class="event-item">
        <button class="event" type="button" aria-expanded="false" aria-controls="journey-ieee" data-journey-toggle>
          IEEE Assistant Officer — External Activities &amp; Events (UT Austin)
          <span class="event-hint" aria-hidden="true">Click to expand</span>
        </button>
        <div class="event-details" id="journey-ieee" hidden>
          <p class="subtle">Built a long-term project program to develop hardware used by the non-profit IT Bridge.</p>
          <ul class="event-bullets">
            <li>Planned and executed events for the entire chapter</li>
            <li>Created repeatable, approachable hardware builds that scale</li>
          </ul>
        </div>
      </div>

      <div class="event-item">
        <button class="event" type="button" aria-expanded="false" aria-controls="journey-uta" data-journey-toggle>
          University of Texas at Austin — Electrical &amp; Computer Engineering
          <span class="event-hint" aria-hidden="true">Click to expand</span>
        </button>
        <div class="event-details" id="journey-uta" hidden>
          <p class="subtle">Honors Robotics Program, Robotics Minor — Expected Graduation: 2029</p>
          <ul class="event-bullets">
            <li>Related coursework: Multivariable Calculus, Electrical Engineering, Embedded Systems</li>
            <li>Current focus: low-level computer architecture, embedded systems, and medical robotics (haptics)</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section id="contact" class="section">
    <h2>Contact</h2>
    <div class="contact">
      <p class="wide">If you’re building something real-world and reliability-focused, I’d love to connect.</p>
      <div class="contact-actions">
          <a class="btn" href="mailto:connormckelvey@utexas.edu">Email me</a>
          <a class="btn btn-ghost" href="tel:+13462256981">Call / text</a>
        <a class="btn btn-ghost" href="connor-mckelvey-resume.pdf" target="_blank" rel="noopener">Open resume</a>
      </div>
      <div class="socials" aria-label="Social links">
        <a class="social" href="https://github.com/connormmckelvey" target="_blank" rel="noopener">GitHub</a>
          <a class="social" href="https://www.linkedin.com/in/connor-mckelvey-8591a6201/" target="_blank" rel="noopener">LinkedIn</a>
      </div>
        <p class="subtle">Best way to reach me: email or LinkedIn.</p>
    </div>
  </section>

  </main>

  <footer>
    <p>© Connor McKelvey · Built like a machine, inspired by nature</p>
  </footer>

  <a class="to-top" href="#top" aria-label="Back to top">Back to top</a>

  <button class="fun-fab" type="button" data-fun-toggle aria-pressed="false" title="Toggle Fun Mode" aria-label="Toggle Fun Mode">Fun</button>

  <div class="compass" data-compass aria-hidden="true" hidden>
    <div class="compass-face"></div>
    <div class="compass-needle" data-needle></div>
    <div class="compass-center"></div>
    <div class="compass-label" data-label>NE</div>
  </div>

  <div class="trail-hud" data-trail-hud aria-label="Trail progress" hidden>
    <div class="trail-hud-title">Trail</div>
    <div class="trail-track" aria-hidden="true">
      <div class="trail-fill" data-trail-fill></div>
    </div>
    <div class="trail-markers" data-trail-markers aria-label="Waypoints"></div>
  </div>

  <div class="modal" id="cmdk" hidden>
    <div class="modal-backdrop" data-cmdk-close></div>
    <div class="modal-dialog cmdk" role="dialog" aria-modal="true" aria-labelledby="cmdk-title">
      <button class="modal-close" type="button" data-cmdk-close aria-label="Close quick navigation">×</button>
      <h3 id="cmdk-title">Quick navigation</h3>
      <p class="subtle">Press <strong>K</strong> or <strong>Ctrl + K</strong>. Type to filter.</p>
      <input class="cmdk-input" type="search" inputmode="search" autocomplete="off" spellcheck="false" placeholder="Go to… (projects, skills, contact)" aria-label="Search sections" data-cmdk-input />
      <div class="cmdk-list" role="listbox" aria-label="Navigation results" data-cmdk-list></div>
      <p class="subtle cmdk-hint">Tip: use ↑/↓ then Enter.</p>
    </div>
  </div>

  <div class="modal" id="project-modal" hidden>
    <div class="modal-backdrop" data-close></div>
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="project-modal-title">
      <button class="modal-close" type="button" data-close aria-label="Close dialog">×</button>
      <h3 id="project-modal-title">Project</h3>
      <p class="subtle" id="project-modal-subtitle"></p>
      <p class="wide" id="project-modal-desc"></p>
      <ul class="modal-bullets" id="project-modal-bullets"></ul>
      <div class="tags" id="project-modal-tags" aria-label="Project tags"></div>
    </div>
  </div>

  <script>
    (() => {
      const root = document.getElementById('github-repos');
      if (!root) return;

      const username = root.dataset.username;
      const source = root.dataset.source || 'recent';
      const statusEl = root.querySelector('[data-status]');
      const gridEl = root.querySelector('[data-grid]');
      const profileEl = root.querySelector('[data-profile]');
      const langsEl = root.querySelector('[data-langs]');

      if (!username || !statusEl || !gridEl || !profileEl) return;

      profileEl.href = `https://github.com/${username}`;
      profileEl.textContent = `github.com/${username}`;

      const fmtUpdated = (iso) => {
        try {
          const date = new Date(iso);
          return new Intl.DateTimeFormat(undefined, { year: 'numeric', month: 'short' }).format(date);
        } catch {
          return '';
        }
      };

      const normalizeRepo = (repo) => {
        const name = repo?.repo || repo?.name || '';
        const htmlUrl = repo?.link || repo?.html_url || (name ? `https://github.com/${username}/${name}` : `https://github.com/${username}`);

        return {
          name,
          html_url: htmlUrl,
          description: repo?.description || '',
          language: repo?.language || '',
          stargazers_count: repo?.stars ?? repo?.stargazers_count ?? 0,
          updated_at: repo?.updated_at || ''
        };
      };

      const makeRepoCard = (repo) => {
        const normalized = normalizeRepo(repo);

        const a = document.createElement('a');
        a.className = 'card repo-card';
        a.href = normalized.html_url;
        a.target = '_blank';
        a.rel = 'noopener';

        const name = document.createElement('h3');
        name.textContent = normalized.name || 'Repository';

        const desc = document.createElement('p');
        desc.textContent = normalized.description || 'A project with details on GitHub.';

        const meta = document.createElement('div');
        meta.className = 'repo-meta';

        const lang = document.createElement('span');
        lang.className = 'chip';
        lang.textContent = normalized.language || 'Code';

        const stars = document.createElement('span');
        stars.className = 'chip';
        stars.textContent = `★ ${normalized.stargazers_count ?? 0}`;

        const updated = document.createElement('span');
        updated.className = 'chip chip-muted';
        updated.textContent = normalized.updated_at ? `Updated ${fmtUpdated(normalized.updated_at)}` : 'Pinned';

        meta.append(lang, stars, updated);
        a.append(name, desc, meta);
        return a;
      };

      const loadRecent = async () => {
        const url = new URL(`https://api.github.com/users/${username}/repos`);
        url.searchParams.set('per_page', '12');
        url.searchParams.set('sort', 'updated');

        const res = await fetch(url, {
          headers: { 'Accept': 'application/vnd.github+json' }
        });
        if (!res.ok) throw new Error(`GitHub API returned ${res.status}`);
        const repos = await res.json();

        return repos
          .filter(r => !r.fork && !r.archived)
          .slice(0, 6);
      };

      const renderLangSummary = (repos) => {
        if (!langsEl) return;

        const counts = new Map();
        for (const repo of repos) {
          const lang = repo?.language;
          if (!lang) continue;
          counts.set(lang, (counts.get(lang) || 0) + 1);
        }

        const entries = [...counts.entries()]
          .sort((a, b) => b[1] - a[1])
          .slice(0, 5);

        if (!entries.length) {
          langsEl.hidden = true;
          langsEl.textContent = '';
          return;
        }

        const total = entries.reduce((sum, [, v]) => sum + v, 0);
        langsEl.hidden = false;
        langsEl.replaceChildren(
          ...entries.map(([name, value]) => {
            const row = document.createElement('div');
            row.className = 'lang-row';

            const label = document.createElement('div');
            label.className = 'lang-label';
            label.textContent = name;

            const bar = document.createElement('div');
            bar.className = 'lang-bar';

            const fill = document.createElement('div');
            fill.className = 'lang-fill';
            fill.style.width = `${Math.round((value / total) * 100)}%`;

            bar.append(fill);
            row.append(label, bar);
            return row;
          })
        );
      };

      const loadPinned = async () => {
        const url = new URL('https://gh-pinned-repos.egoist.dev/');
        url.searchParams.set('username', username);

        const res = await fetch(url, {
          headers: { 'Accept': 'application/json' }
        });
        if (!res.ok) throw new Error(`Pinned repos service returned ${res.status}`);
        const repos = await res.json();
        return Array.isArray(repos) ? repos.slice(0, 6) : [];
      };

      const load = async () => {
        statusEl.textContent = 'Loading repositories…';

        try {
          const repos = source === 'pinned' ? await loadPinned() : await loadRecent();
          if (repos.length) {
            gridEl.replaceChildren(...repos.map(makeRepoCard));
            statusEl.textContent = source === 'pinned' ? 'Pinned repos:' : 'Recently updated public repos:';
            if (source !== 'pinned') renderLangSummary(repos);
            return;
          }

          if (source === 'pinned') {
            const fallback = await loadRecent();
            if (fallback.length) {
              gridEl.replaceChildren(...fallback.map(makeRepoCard));
              statusEl.textContent = 'Pinned repos unavailable — showing recent repos:';
              return;
            }
          }

          statusEl.textContent = 'No public repositories found.';
        } catch (err) {
          console.warn('GitHub repos failed to load:', err);
          statusEl.textContent = source === 'pinned'
            ? 'Pinned repos can’t be fetched without GitHub GraphQL auth; using a public pinned-repos service. It may be blocked/limited — try again later.'
            : 'Could not load repositories (GitHub rate limit or network).';
          gridEl.innerHTML = '';
          if (langsEl) langsEl.hidden = true;
        }
      };

      load();
    })();

    (() => {
      const nav = document.querySelector('.nav');
      const navLinks = nav ? [...nav.querySelectorAll('a[href^="#"]')] : [];
      const sections = navLinks
        .map(a => document.querySelector(a.getAttribute('href')))
        .filter(Boolean);

      const setActive = (id) => {
        for (const a of navLinks) {
          const isActive = a.getAttribute('href') === `#${id}`;
          a.classList.toggle('is-active', isActive);
          if (isActive) a.setAttribute('aria-current', 'page');
          else a.removeAttribute('aria-current');
        }
      };

      if (sections.length && 'IntersectionObserver' in window) {
        const obs = new IntersectionObserver((entries) => {
          const visible = entries
            .filter(e => e.isIntersecting)
            .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];
          if (visible?.target?.id) setActive(visible.target.id);
        }, { rootMargin: `-${Math.round(parseInt(getComputedStyle(document.documentElement).getPropertyValue('--nav-height') || '68', 10) + 24)}px 0px -70% 0px`, threshold: [0.15, 0.3, 0.6] });

        sections.forEach(s => obs.observe(s));
      }

      const toTop = document.querySelector('.to-top');
      const onScroll = () => {
        const show = window.scrollY > 600;
        if (toTop) toTop.classList.toggle('is-visible', show);
      };
      window.addEventListener('scroll', onScroll, { passive: true });
      onScroll();

      const filterButtons = [...document.querySelectorAll('[data-filter]')];
      const projectCards = [...document.querySelectorAll('.project-card')];
      const projectsStatus = document.getElementById('projects-status');

      const applyFilter = (tag) => {
        for (const btn of filterButtons) {
          const isOn = btn.dataset.filter === tag;
          btn.setAttribute('aria-pressed', String(isOn));
          btn.classList.toggle('is-active', isOn);
        }

        let shown = 0;
        for (const card of projectCards) {
          const tags = (card.dataset.tags || '').split(/\s+/).filter(Boolean);
          const matches = tag === 'all' || tags.includes(tag);
          card.hidden = !matches;
          if (matches) shown += 1;
        }

        if (projectsStatus) {
          projectsStatus.textContent = tag === 'all' ? '' : `Showing ${shown} project${shown === 1 ? '' : 's'} tagged “${tag}”.`;
        }
      };

      filterButtons.forEach(btn => {
        btn.addEventListener('click', () => applyFilter(btn.dataset.filter || 'all'));
      });

      const modal = document.getElementById('project-modal');
      const modalTitle = document.getElementById('project-modal-title');
      const modalSubtitle = document.getElementById('project-modal-subtitle');
      const modalDesc = document.getElementById('project-modal-desc');
      const modalBullets = document.getElementById('project-modal-bullets');
      const modalTags = document.getElementById('project-modal-tags');
      let lastFocus = null;

      const PROJECTS = {
        fireball: {
          title: 'Fireball Dice Roller — Discord Bot',
          subtitle: 'Verified bot at real scale',
          desc: 'Built and published a verified Discord bot used by 10,000+ users across 150 servers. Designed for reliability at scale and flexible dice mechanics across tabletop systems.',
          bullets: [
            'Python + Discord API implementation with production-minded event handling',
            'Customizable dice engine for complex rolls, modifiers, and multiple TTRPG systems',
            'Built for predictable behavior under real user load (rate limits, retries, edge cases)',
            'Shipped as a verified bot with real production users and long-term maintenance'
          ],
          tags: ['tooling', 'python', 'discord api']
        },
        logic: {
          title: 'Circuit Board Digital Logic Simulator',
          subtitle: 'Interactive logic education',
          desc: 'Developed a grid-based graphical simulator in Godot for teaching digital logic. Emphasized a visual, interactive workflow that makes signals and logic flow easy to understand.',
          bullets: [
            'Grid-based editor for building circuits quickly',
            'Boolean algebra operators implemented as interactive components',
            'Visualization-first UX for learning and debugging logic'
          ],
          tags: ['tooling', 'education', 'godot']
        },
        curriculum: {
          title: 'High School CS Curriculum (Bavaria)',
          subtitle: '14-lesson, project-based sequence',
          desc: 'Collaborated with a teacher to design a project-based, game-development curriculum for 10th grade. The sequence teaches Object Oriented Programming and Composition through hands-on projects.',
          bullets: [
            'Structured 14 lessons with progressive project difficulty',
            'Teaches OOP + composition through game-dev work',
            'Optimized for classroom pacing, clarity, and student engagement'
          ],
          tags: ['education', 'systems', 'writing']
        },
        arm: {
          title: 'Drawing Robot Arm',
          subtitle: 'From pixels to motion',
          desc: 'Built a two-jointed drawing arm that converts a digital image into a physical drawing. Used to standardize stimuli for research on bias against AI creativity in artwork (Professor Dempster’s Being Creative class).',
          bullets: [
            'Inverse kinematics for a two-jointed arm',
            'Image simplification pipeline that turns pixels into drawable paths',
            'Serial communication + data buffering for smooth execution',
            'Designed for repeatability so results are comparable across trials'
          ],
          tags: ['robotics', 'embedded', 'controls']
        },
        itbridge: {
          title: 'IEEE Hardware Program (IT Bridge)',
          subtitle: 'Hands-on engineering education',
          desc: 'Created a long-term project program (through IEEE) to develop hardware used by the non-profit IT Bridge to teach underprivileged youth about careers in Electrical Engineering.',
          bullets: [
            'Built an ongoing program (not a one-off demo) for repeatable impact',
            'Planned and executed chapter-wide events and build sessions',
            'Focused on approachable hardware learning through real tools'
          ],
          tags: ['embedded', 'education', 'leadership']
        },
        krazy: {
          title: 'Krazy Studios',
          subtitle: 'Founder + builder',
          desc: 'Established and led a team to publish chatbots and Discord-based games, delivering private client bots and building community engagement.',
          bullets: [
            'Led delivery for private client bots and games',
            'Built community engagement through interactive experiences',
            'Practiced real-world leadership: delegation, reliability, and shipping'
          ],
          tags: ['leadership', 'tooling', 'systems']
        }
      };

      const openModal = (key) => {
        const data = PROJECTS[key];
        if (!modal || !data) return;
        lastFocus = document.activeElement;

        if (modalTitle) modalTitle.textContent = data.title;
        if (modalSubtitle) modalSubtitle.textContent = data.subtitle;
        if (modalDesc) modalDesc.textContent = data.desc;

        if (modalBullets) {
          modalBullets.replaceChildren(
            ...data.bullets.map(t => {
              const li = document.createElement('li');
              li.textContent = t;
              return li;
            })
          );
        }

        if (modalTags) {
          modalTags.replaceChildren(
            ...data.tags.map(t => {
              const s = document.createElement('span');
              s.textContent = t;
              return s;
            })
          );
        }

        modal.hidden = false;
        document.body.classList.add('modal-open');

        const focusable = modal.querySelector('button,[href],[tabindex]:not([tabindex="-1"])');
        focusable?.focus?.();
      };

      const closeModal = () => {
        if (!modal || modal.hidden) return;
        modal.hidden = true;
        document.body.classList.remove('modal-open');
        if (lastFocus && typeof lastFocus.focus === 'function') lastFocus.focus();
      };

      document.addEventListener('click', (e) => {
        const openBtn = e.target?.closest?.('[data-open-project]');
        if (openBtn) {
          openModal(openBtn.getAttribute('data-open-project'));
          return;
        }

        const closeBtn = e.target?.closest?.('[data-close]');
        if (closeBtn) {
          closeModal();
        }
      });

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });

      // Cursor-following spotlight for cards (tiny JS, big feel).
      const grids = document.querySelectorAll('.card-grid');
      grids.forEach(grid => {
        grid.addEventListener('pointermove', (e) => {
          const card = e.target?.closest?.('.card');
          if (!card) return;
          const r = card.getBoundingClientRect();
          const x = Math.round(e.clientX - r.left);
          const y = Math.round(e.clientY - r.top);
          card.style.setProperty('--mx', `${x}px`);
          card.style.setProperty('--my', `${y}px`);
        });
      });

      applyFilter('all');
    })();

    (() => {
      const root = document.querySelector('[data-journey]');
      if (!root) return;

      const toggles = [...root.querySelectorAll('[data-journey-toggle]')];
      if (!toggles.length) return;

      const getDetails = (btn) => {
        const id = btn.getAttribute('aria-controls');
        return id ? document.getElementById(id) : null;
      };

      const close = (btn) => {
        btn.setAttribute('aria-expanded', 'false');
        const details = getDetails(btn);
        if (details) details.hidden = true;
        btn.closest('.event-item')?.classList?.remove?.('is-open');
      };

      const open = (btn) => {
        btn.setAttribute('aria-expanded', 'true');
        const details = getDetails(btn);
        if (details) details.hidden = false;
        btn.closest('.event-item')?.classList?.add?.('is-open');
      };

      const closeAll = (except) => {
        for (const btn of toggles) {
          if (btn === except) continue;
          close(btn);
        }
      };

      for (const btn of toggles) {
        // Ensure details start hidden.
        close(btn);

        btn.addEventListener('click', () => {
          const isOpen = btn.getAttribute('aria-expanded') === 'true';
          if (isOpen) {
            close(btn);
            return;
          }
          closeAll(btn);
          open(btn);
        });

        // Space should toggle like a native details/summary.
        btn.addEventListener('keydown', (e) => {
          if (e.key === ' ') {
            e.preventDefault();
            btn.click();
          }
        });
      }

      // Escape closes any open entry when focus is within Journey.
      root.addEventListener('keydown', (e) => {
        if (e.key !== 'Escape') return;
        closeAll(null);
      });
    })();

    (() => {
      const toggle = document.querySelector('[data-fun-toggle]');
      const compass = document.querySelector('[data-compass]');
      const needle = document.querySelector('[data-needle]');
      const label = document.querySelector('[data-label]');
      if (!toggle) return;

      const prefersReducedMotion = () => window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const storageKey = 'cm_fun_mode';

      let canvas = null;
      let ctx = null;
      let rafId = 0;
      let w = 0;
      let h = 0;

      const pointer = { x: 0.5, y: 0.35, vx: 0, vy: 0, has: false };
      const particles = [];
      const maxParticles = 28;

      const clamp = (n, lo, hi) => Math.max(lo, Math.min(hi, n));

      const headingLabel = (deg) => {
        const d = (deg + 360) % 360;
        if (d >= 337.5 || d < 22.5) return 'E';
        if (d < 67.5) return 'NE';
        if (d < 112.5) return 'N';
        if (d < 157.5) return 'NW';
        if (d < 202.5) return 'W';
        if (d < 247.5) return 'SW';
        if (d < 292.5) return 'S';
        return 'SE';
      };

      const ensureCanvas = () => {
        if (canvas) return;
        canvas = document.createElement('canvas');
        canvas.className = 'fun-canvas';
        canvas.setAttribute('aria-hidden', 'true');
        canvas.style.pointerEvents = 'none';
        document.body.append(canvas);
        ctx = canvas.getContext('2d', { alpha: true });
      };

      const resize = () => {
        if (!canvas) return;
        const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
        w = Math.floor(window.innerWidth);
        h = Math.floor(window.innerHeight);
        canvas.width = Math.floor(w * dpr);
        canvas.height = Math.floor(h * dpr);
        canvas.style.width = `${w}px`;
        canvas.style.height = `${h}px`;
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      };

      const spawnParticle = (x, y) => {
        if (!particles.length) {
          for (let i = 0; i < maxParticles; i++) {
            particles.push({ x, y, vx: 0, vy: 0, a: 0, life: 0, hue: 0, r: 0 });
          }
        }

        const p = particles.shift();
        p.x = x;
        p.y = y;
        p.vx = (Math.random() - 0.5) * 1.2;
        p.vy = (Math.random() - 0.5) * 1.2;
        p.a = 0.95;
        p.life = 1;
        p.hue = 150 + Math.random() * 40;
        p.r = 1.6 + Math.random() * 2.4;
        particles.push(p);
      };

      const tick = () => {
        rafId = window.requestAnimationFrame(tick);
        if (!ctx || !canvas) return;

        ctx.clearRect(0, 0, w, h);

        if (pointer.has) {
          const px = pointer.x * w;
          const py = pointer.y * h;
          const speed = Math.hypot(pointer.vx, pointer.vy);
          const rate = clamp(Math.round(speed * 1.6), 1, 6);
          for (let i = 0; i < rate; i++) spawnParticle(px + (Math.random() - 0.5) * 10, py + (Math.random() - 0.5) * 10);
        }

        for (const p of particles) {
          p.life *= 0.94;
          p.a *= 0.965;
          p.vx *= 0.985;
          p.vy *= 0.985;
          p.x += p.vx;
          p.y += p.vy;

          const alpha = clamp(p.a * p.life, 0, 1);
          if (alpha < 0.02) continue;

          const g = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, 14);
          g.addColorStop(0, `hsla(${p.hue}, 90%, 70%, ${alpha})`);
          g.addColorStop(1, `hsla(${p.hue}, 90%, 70%, 0)`);
          ctx.fillStyle = g;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 14, 0, Math.PI * 2);
          ctx.fill();

          ctx.fillStyle = `rgba(231, 246, 238, ${alpha * 0.55})`;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
          ctx.fill();
        }
      };

      const onPointerMove = (e) => {
        const x = clamp(e.clientX / Math.max(1, window.innerWidth), 0, 1);
        const y = clamp(e.clientY / Math.max(1, window.innerHeight), 0, 1);
        pointer.vx = x - pointer.x;
        pointer.vy = y - pointer.y;
        pointer.x = x;
        pointer.y = y;
        pointer.has = true;

        if (needle && compass) {
          const cx = window.innerWidth * 0.5;
          const cy = window.innerHeight * 0.5;
          const dx = e.clientX - cx;
          const dy = e.clientY - cy;
          const deg = (Math.atan2(-dy, dx) * 180) / Math.PI;
          needle.style.transform = `rotate(${-deg}deg)`;
          if (label) label.textContent = headingLabel(deg);
        }
      };

      const enable = () => {
        document.body.classList.add('fun-on');
        toggle.setAttribute('aria-pressed', 'true');
        try { localStorage.setItem(storageKey, '1'); } catch { }

        if (compass) compass.hidden = false;

        // Always track pointer for compass; only animate particles if motion is allowed.
        window.addEventListener('pointermove', onPointerMove, { passive: true });
        if (!prefersReducedMotion()) {
          ensureCanvas();
          resize();
          window.addEventListener('resize', resize, { passive: true });
          if (!rafId) rafId = window.requestAnimationFrame(tick);
        }
      };

      const disable = () => {
        document.body.classList.remove('fun-on');
        toggle.setAttribute('aria-pressed', 'false');
        try { localStorage.setItem(storageKey, '0'); } catch { }

        if (compass) compass.hidden = true;

        window.removeEventListener('resize', resize);
        window.removeEventListener('pointermove', onPointerMove);

        if (rafId) {
          window.cancelAnimationFrame(rafId);
          rafId = 0;
        }
        if (canvas) {
          canvas.remove();
          canvas = null;
          ctx = null;
        }
        pointer.has = false;
      };

      const isOn = () => document.body.classList.contains('fun-on');

      toggle.addEventListener('click', () => {
        if (isOn()) disable();
        else enable();
      });

      // Restore last setting.
      let shouldEnable = false;
      try { shouldEnable = localStorage.getItem(storageKey) === '1'; } catch { }
      if (shouldEnable) enable();
    })();

    (() => {
      // Tiny easter egg: type "TRAIL" to trigger a brief night-hike aurora shimmer.
      const hintDelayMs = 7000;
      const hintDismissMs = 5000;
      const code = 'trail';
      const maxLen = 10;
      let buffer = '';
      let hintEl = null;
      let idleTimer = 0;
      let hintTimer = 0;
      let lastActivity = Date.now();

      const funIsOn = () => document.body.classList.contains('fun-on');

      const prefersReducedMotion = () => window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      const markActivity = () => {
        lastActivity = Date.now();
        if (hintEl) hintEl.remove();
        hintEl = null;
        if (hintTimer) {
          window.clearTimeout(hintTimer);
          hintTimer = 0;
        }
      };

      const ensureHint = () => {
        if (!funIsOn()) return;
        if (hintEl) return;
        hintEl = document.createElement('div');
        hintEl.className = 'easter-hint';
        hintEl.textContent = 'psst… type TRAIL';
        document.body.append(hintEl);

        hintTimer = window.setTimeout(() => {
          if (hintEl) hintEl.remove();
          hintEl = null;
          hintTimer = 0;
        }, hintDismissMs);
      };

      const tickIdle = () => {
        if (idleTimer) window.clearTimeout(idleTimer);
        idleTimer = window.setTimeout(() => {
          if (!funIsOn()) {
            if (hintEl) hintEl.remove();
            hintEl = null;
          } else if (Date.now() - lastActivity >= hintDelayMs) {
            ensureHint();
          }
          tickIdle();
        }, 1000);
      };

      const trigger = () => {
        document.body.classList.add('night-hike');
        window.setTimeout(() => document.body.classList.remove('night-hike'), prefersReducedMotion() ? 2500 : 6500);
      };

      const onKeyDown = (e) => {
        // Don't hijack typing in inputs.
        const tag = (e.target && e.target.tagName) ? String(e.target.tagName).toLowerCase() : '';
        if (tag === 'input' || tag === 'textarea') return;

        if (typeof e.key !== 'string' || e.key.length !== 1) return;
        markActivity();
        buffer = (buffer + e.key.toLowerCase()).slice(-maxLen);
        if (buffer.endsWith(code)) trigger();
      };

      window.addEventListener('mousemove', markActivity, { passive: true });
      window.addEventListener('pointerdown', markActivity, { passive: true });
      window.addEventListener('scroll', markActivity, { passive: true });
      window.addEventListener('keydown', onKeyDown);
      tickIdle();
    })();

    (() => {
      const hud = document.querySelector('[data-trail-hud]');
      const fill = document.querySelector('[data-trail-fill]');
      const markersRoot = document.querySelector('[data-trail-markers]');
      if (!hud || !fill || !markersRoot) return;

      const prefersReducedMotion = () => window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      const waypoints = [
        { label: 'Projects', id: 'projects' },
        { label: 'Education', id: 'education' },
        { label: 'GitHub', id: 'github' },
        { label: 'About', id: 'about' },
        { label: 'Contact', id: 'contact' }
      ]
        .map(w => ({ ...w, el: document.getElementById(w.id) }))
        .filter(w => w.el);

      if (!waypoints.length) return;

      hud.hidden = false;

      const scrollToEl = (el) => {
        el?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth', block: 'start' });
      };

      const buttons = waypoints.map((w) => {
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'trail-marker';
        b.innerHTML = `<span>${w.label}</span><span class="trail-dot" aria-hidden="true"></span>`;
        b.addEventListener('click', () => scrollToEl(w.el));
        markersRoot.append(b);
        return b;
      });

      const update = () => {
        const doc = document.documentElement;
        const max = Math.max(1, doc.scrollHeight - window.innerHeight);
        const pct = Math.max(0, Math.min(1, (window.scrollY || doc.scrollTop || 0) / max));
        fill.style.height = `${Math.round(pct * 100)}%`;

        const targetY = (window.scrollY || 0) + window.innerHeight * 0.35;
        let activeIndex = 0;
        for (let i = 0; i < waypoints.length; i++) {
          const top = waypoints[i].el.getBoundingClientRect().top + (window.scrollY || 0);
          if (top <= targetY) activeIndex = i;
        }
        buttons.forEach((b, i) => b.classList.toggle('is-active', i === activeIndex));
      };

      window.addEventListener('scroll', update, { passive: true });
      window.addEventListener('resize', update, { passive: true });
      update();
    })();

    (() => {
      const modal = document.getElementById('cmdk');
      const input = modal?.querySelector?.('[data-cmdk-input]');
      const list = modal?.querySelector?.('[data-cmdk-list]');
      const closeEls = modal ? [...modal.querySelectorAll('[data-cmdk-close]')] : [];
      if (!modal || !input || !list) return;

      const prefersReducedMotion = () => window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      const items = [
        { title: 'Projects', keywords: 'projects work portfolio', run: () => document.getElementById('projects')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'Education', keywords: 'education ut austin ece robotics', run: () => document.getElementById('education')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'Leadership', keywords: 'leadership experience ieee eagle scout', run: () => document.getElementById('leadership')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'Skills', keywords: 'skills tech tools', run: () => document.getElementById('skills')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'GitHub', keywords: 'github repos', run: () => document.getElementById('github')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'About', keywords: 'about philosophy', run: () => document.getElementById('about')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'Contact', keywords: 'contact email linkedin phone', run: () => document.getElementById('contact')?.scrollIntoView?.({ behavior: prefersReducedMotion() ? 'auto' : 'smooth' }) },
        { title: 'Blog', keywords: 'blog field notes posts', run: () => { window.location.href = 'blog.html'; } },
        { title: 'Open resume (PDF)', keywords: 'resume pdf', run: () => window.open('connor-mckelvey-resume.pdf', '_blank', 'noopener') }
      ];

      let isOpen = false;
      let active = 0;
      let results = items;
      let lastFocus = null;

      const choose = (item) => {
        if (!item) return;
        setOpen(false);
        window.requestAnimationFrame(() => item.run?.());
      };

      const setOpen = (on) => {
        isOpen = on;
        modal.hidden = !on;
        document.body.classList.toggle('modal-open', on);
        if (on) {
          lastFocus = document.activeElement;
          input.value = '';
          active = 0;
          render();
          input.focus();
        } else {
          if (lastFocus && typeof lastFocus.focus === 'function') lastFocus.focus();
        }
      };

      const render = () => {
        const q = input.value.trim().toLowerCase();
        results = !q
          ? items
          : items.filter(i => (i.title + ' ' + (i.keywords || '')).toLowerCase().includes(q));

        if (active >= results.length) active = Math.max(0, results.length - 1);
        active = Math.min(active, Math.max(0, Math.min(9, results.length - 1)));

        list.replaceChildren(
          ...results.slice(0, 10).map((item, idx) => {
            const el = document.createElement('div');
            el.className = 'cmdk-item' + (idx === active ? ' is-active' : '');
            el.tabIndex = 0;
            el.setAttribute('role', 'option');
            el.setAttribute('aria-selected', String(idx === active));

            const name = document.createElement('div');
            name.textContent = item.title;

            const kbd = document.createElement('div');
            kbd.className = 'cmdk-kbd';
            kbd.textContent = '↵';

            el.append(name, kbd);
            el.addEventListener('mouseenter', () => {
              active = idx;
              render();
            });
            el.addEventListener('click', () => {
              choose(item);
            });
            return el;
          })
        );
      };

      const open = () => setOpen(true);
      const close = () => setOpen(false);

      closeEls.forEach(el => el.addEventListener('click', close));

      document.addEventListener('keydown', (e) => {
        const tag = (e.target && e.target.tagName) ? String(e.target.tagName).toLowerCase() : '';
        const inText = tag === 'input' || tag === 'textarea';

        const isCtrlK = (e.key.toLowerCase?.() === 'k') && (e.ctrlKey || e.metaKey);
        const isPlainK = (e.key.toLowerCase?.() === 'k') && !e.ctrlKey && !e.metaKey && !e.altKey;

        if (!isOpen && (isCtrlK || (isPlainK && !inText))) {
          e.preventDefault();
          open();
          return;
        }

        if (!isOpen) return;

        if (e.key === 'Escape') {
          e.preventDefault();
          close();
          return;
        }
      });

      input.addEventListener('input', render);
      input.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowDown') {
          e.preventDefault();
          active = Math.min(active + 1, Math.max(0, Math.min(9, results.length - 1)));
          render();
        } else if (e.key === 'ArrowUp') {
          e.preventDefault();
          active = Math.max(active - 1, 0);
          render();
        } else if (e.key === 'Enter') {
          e.preventDefault();
          const chosen = results[active];
          choose(chosen);
        }
      });
    })();
  </script>

</body>
</html>
